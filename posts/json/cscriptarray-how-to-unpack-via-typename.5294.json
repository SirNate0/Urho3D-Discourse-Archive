{"post_stream":{"posts":[{"id":30712,"name":"Leith Ketchell","username":"Leith","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","created_at":"2019-07-11T09:22:45.080Z","cooked":"\u003cp\u003eSo, AngelScript has returned an array type to C++ caller‚Ä¶ it‚Äôs a CScriptArray\u003cbr\u003e\nI can tell the subtype is Node@.\u003cbr\u003e\nie, the script returned an Array\u0026lt;Node@\u0026gt;\u003c/p\u003e\n\u003cp\u003eI want to unpack the CScriptArray to a Vector\u0026lt;Node*\u0026gt;, and/or VariantVector.\u003cbr\u003e\nI know the typename is Node.\u003cbr\u003e\nHow can I get there?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2019-07-11T09:23:33.820Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":25,"readers_count":24,"score":20.0,"yours":false,"topic_id":5294,"topic_slug":"cscriptarray-how-to-unpack-via-typename","display_username":"Leith Ketchell","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"suspended user","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1098,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":30722,"name":"SirNate0","username":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","created_at":"2019-07-11T11:58:29.855Z","cooked":"\u003cp\u003eDoes something like \u003ccode\u003eVector\u0026lt;T\u0026gt; ArrayToVector(CScriptArray* arr)\u003c/code\u003e work from the AngelScript/APITemplates.h file?\u003c/p\u003e\n\u003cp\u003eOr is the idea to do it with a non-template function that takes a String[Hash] of the typename? If the latter, I would go with putting everything in a Variant and use a VariantVector, as you‚Äôve already basically solved how to do that from just the type name for generic return values, right?\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2019-07-11T11:58:29.855Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":24,"readers_count":23,"score":24.8,"yours":false,"topic_id":5294,"topic_slug":"cscriptarray-how-to-unpack-via-typename","display_username":"SirNate0","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":628,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":30726,"name":"Leith Ketchell","username":"Leith","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","created_at":"2019-07-12T03:58:37.122Z","cooked":"\u003cp\u003eI can‚Äôt use template methods such as ArrayToVector because I can‚Äôt presume to know in advance what data type(s) I‚Äôll be working with - I do have access to name strings‚Ä¶\u003c/p\u003e\n\u003cp\u003eI think I have solved the issue‚Ä¶ required some further changes to ScriptFile.cpp but essentially I‚Äôm leveraging the fact that angelscript arrays can only hold two kinds of objects: handles and values. With one special exception case, handles typically represent pointers to Urho objects that derive from RefCounter. Values are typically types whose Urho type info can be queried from Variant::GetTypeFromName, with the only notable exception being that Variant itself is a supported value type.\u003c/p\u003e\n\u003cp\u003eIf I give up on template specialization at runtime, and restrict myself to VariantVector, it looks like I‚Äôll be able to handle angelscript array runtime specialization with what little type information I have.\u003c/p\u003e\n\u003cp\u003eThis effectively means that angelscript array will always be unpacked into a VariantVector when returning arrays from angelscript to c++ caller.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2019-07-12T04:00:16.529Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":18,"readers_count":17,"score":23.6,"yours":false,"topic_id":5294,"topic_slug":"cscriptarray-how-to-unpack-via-typename","display_username":"Leith Ketchell","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"suspended user","title_is_group":false,"reply_to_user":{"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1098,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":30737,"name":"Jonathan","username":"Sinoid","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png","created_at":"2019-07-13T02:56:22.742Z","cooked":"\u003cp\u003eIt‚Äôs a bit painful but the \u003ca href=\"https://gist.github.com/JSandusky/51f12192f40b90b4a09ee9138820e74c\" rel=\"nofollow noopener\"\u003easPEEK debugging code\u003c/a\u003e shows more of the nitty-gritty of accessing Angelscript objects C++ side. Can‚Äôt for the life of me remember how much array handling there was ‚Ä¶ I do recall it and remembering it sucked.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIf I give up on template specialization at runtime, and restrict myself to VariantVector, it looks like I‚Äôll be able to handle angelscript array runtime specialization with what little type information I have.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThat‚Äôs probably the smarter choice. Restricting to VariantVector / StringVector / ResourceRefList returns implies a lot in regards to constraints and reduces how robust you might have to be.\u003c/p\u003e\n\u003cp\u003eIf a returned CScriptArray contains exclusively angelscript defined types then any C++ code attempting to store them will have to bump/dec the reference counts for those objects. Obviously you don‚Äôt look to be after going that far, but using the generic type looks like you could be.\u003c/p\u003e\n\u003cp\u003eVariantVector (and kin) makes it a lot clearer ‚Ä¶ provided Variant \u003ccode\u003eVoidPtr\u003c/code\u003e isn‚Äôt supported for Angelscript objects, but that isn‚Äôt that bad as it would still be clear that ref-counts are the end-user‚Äôs responsibility.\u003c/p\u003e\n\u003cp\u003eI‚Äôm warning you of those points specifically because of your BehaviorTree thread - from my own experience with a C++ side BT-core that supported tree-nodes defined in angelscript.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eI‚Äôve done this before, from what I saw in the other thread you‚Äôre on the right track. There is no getting this \u003cem\u003etruly\u003c/em\u003e right, so pick a point and settle on it.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2019-07-13T02:56:22.742Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":0,"reads":16,"readers_count":15,"score":33.2,"yours":false,"topic_id":5294,"topic_slug":"cscriptarray-how-to-unpack-via-typename","display_username":"Jonathan","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://gist.github.com/JSandusky/51f12192f40b90b4a09ee9138820e74c","internal":false,"reflection":false,"title":"asPEEK debugger: add `friend class asPEEK` as needed for access to `Script`' and `ScriptFile` internals ¬∑ GitHub","clicks":2}],"read":true,"user_title":null,"reply_to_user":{"username":"Leith","name":"Leith Ketchell","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":false,"admin":false,"staff":false,"user_id":669,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[30712,30722,30726,30737]},"timeline_lookup":[[1,1231],[3,1230],[4,1229]],"suggested_topics":[{"id":7081,"title":"Install Urho3D Library - Windows 10 - rake build - \"project does not exist\"","fancy_title":"Install Urho3D Library - Windows 10 - rake build - \u0026ldquo;project does not exist\u0026rdquo;","slug":"install-urho3d-library-windows-10-rake-build-project-does-not-exist","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-03T03:06:40.974Z","last_posted_at":"2021-12-03T17:53:10.844Z","bumped":true,"bumped_at":"2021-12-03T17:53:10.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":190,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7065,"title":"Angelscript: Loading a char file into a 2D array: how?","fancy_title":"Angelscript: Loading a char file into a 2D array: how?","slug":"angelscript-loading-a-char-file-into-a-2d-array-how","posts_count":7,"reply_count":4,"highest_post_number":7,"image_url":null,"created_at":"2021-11-24T09:20:05.420Z","last_posted_at":"2021-11-28T11:19:39.689Z","bumped":true,"bumped_at":"2021-11-28T11:26:00.375Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":239,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":983,"username":"tarzeron","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ecae2f/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7129,"title":"Best Model Import Pipeline as of Jan 2022?","fancy_title":"Best Model Import Pipeline as of Jan 2022?","slug":"best-model-import-pipeline-as-of-jan-2022","posts_count":7,"reply_count":0,"highest_post_number":7,"image_url":null,"created_at":"2022-01-17T09:27:23.432Z","last_posted_at":"2022-01-17T20:37:59.458Z","bumped":true,"bumped_at":"2022-01-17T20:37:59.458Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":170,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"}}]},{"id":7181,"title":"StaticModelGroup - Are ShaderParameters Shared?","fancy_title":"StaticModelGroup - Are ShaderParameters Shared?","slug":"staticmodelgroup-are-shaderparameters-shared","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-02-02T09:31:19.658Z","last_posted_at":"2022-02-02T17:06:24.059Z","bumped":true,"bumped_at":"2022-02-02T17:06:24.059Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":120,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7185,"title":"Update Ray ray direction","fancy_title":"Update Ray ray direction","slug":"update-ray-ray-direction","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-02-05T00:28:45.414Z","last_posted_at":"2022-02-05T20:19:51.238Z","bumped":true,"bumped_at":"2022-02-05T20:19:51.238Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":5294,"title":"CScriptArray - how to unpack via typename","fancy_title":"CScriptArray - how to unpack via typename","posts_count":4,"created_at":"2019-07-11T09:22:45.025Z","views":286,"reply_count":2,"like_count":4,"last_posted_at":"2019-07-13T02:56:22.742Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"cscriptarray-how-to-unpack-via-typename","category_id":10,"word_count":555,"deleted_at":null,"user_id":1098,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_5294","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1098,"username":"Leith","name":"Leith Ketchell","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":669,"username":"Sinoid","name":"Jonathan","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1098,"username":"Leith","name":"Leith Ketchell","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png"},"last_poster":{"id":669,"username":"Sinoid","name":"Jonathan","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png"},"links":[{"url":"https://gist.github.com/JSandusky/51f12192f40b90b4a09ee9138820e74c","title":"asPEEK debugger: add `friend class asPEEK` as needed for access to `Script`' and `ScriptFile` internals ¬∑ GitHub","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":669,"domain":"gist.github.com","root_domain":"github.com"}]}}