{"post_stream":{"posts":[{"id":44539,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2022-02-01T09:04:58.772Z","cooked":"\u003cp\u003eSo the question is quite complex. I tried to play with PBR materials and i really like the result. I decided to replace materials in my game with PBR materials (if all goes well).\u003cbr\u003e\nAs you may know i‚Äôm working on a game that uses pre rendered backgrounds that requires very tricky and complex rendering to make it work. Previously (in ForwardHWDepth) i did work out how to render meshes into Depth map ONLY and even succeeded to make these DepthOnly meshes to cast and receive shadows.\u003c/p\u003e\n\u003cp\u003eSo far i managed to do almost the same with PBR (Rendering in depth only and casting shadows by these depth meshes are working) but i just can manage to figure out how to configure my technique to make these ‚ÄúDepth meshes‚Äù receive light and shadows.\u003c/p\u003e\n\u003cp\u003eThis is what i got so far.\u003cbr\u003e\nModified version of PBRDeferredHWDepth.xml :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;renderpath\u0026gt;\n    \u0026lt;rendertarget name=\"specular\" sizedivisor=\"1 1\" format=\"rgba16f\" /\u0026gt;\n    \u0026lt;rendertarget name=\"albedo\" sizedivisor=\"1 1\" format=\"rgba16f\" /\u0026gt;\n    \u0026lt;rendertarget name=\"normal\" sizedivisor=\"1 1\" format=\"rgba16f\" /\u0026gt;\n    \u0026lt;rendertarget name=\"depth\" sizedivisor=\"1 1\" format=\"readabledepth\" /\u0026gt;\n    \u0026lt;command type=\"clear\" color=\"0 0 0 0\" depth=\"1.0\" stencil=\"0\" depthstencil=\"depth\" /\u0026gt;\n    \u0026lt;command type=\"clear\" color=\"0.1 0.7 0.1 0.1\" output=\"albedo\" depthstencil=\"depth\"/\u0026gt;\n    \u0026lt;command type=\"clear\" color=\"0 0 0 0\" output=\"specular\" depthstencil=\"depth\" /\u0026gt;\n    \u0026lt;command type=\"clear\" color=\"0 0 0 0\" output=\"normal\" depthstencil=\"depth\" /\u0026gt;\n\t\n\t\u0026lt;command type=\"quad\" tag=\"PreRendered\" vs=\"PreRendered\" ps=\"PreRendered\" output=\"viewport\" \u0026gt;\n\t\t\u0026lt;parameter name=\"DesaturationPower\" value=\"0.2\" /\u0026gt;\n\t\t\u0026lt;parameter name=\"BlendPassColor\" value=\"0.2 0.22 0.2 1.0\" /\u0026gt;\n\t\t\u0026lt;parameter name=\"GrainValue\" value=\"1.0\" /\u0026gt;\n\t\t\u0026lt;parameter name=\"GrainStrength\" value=\"0.08\" /\u0026gt;\n\t\t\u0026lt;parameter name=\"ScreenSizeOffset\" value=\"1.0 0.937500007\" /\u0026gt;\n\t\t\u0026lt;parameter name=\"ScreenScrollOffset\" value=\"0.0 0.0\" /\u0026gt;\n\t\t\u0026lt;texture unit=\"diffuse\" name=\"viewport\" /\u0026gt;\n\t\t\u0026lt;texture unit=\"normal\" name=\"cathedral_corridor01_CameraZone001.jpg\" /\u0026gt;\n\t \u0026lt;/command\u0026gt;\t\n\t\n    \u0026lt;command type=\"clear\" color=\"0 0 0 0\" depth=\"1.0\" output=\"depth\" depthstencil=\"depth\" /\u0026gt;\n\t\u0026lt;command type=\"scenepass\" pass=\"DepthOnly\" output=\"depth\"/\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"base\" vertexlights=\"true\" metadata=\"base\" depthstencil=\"depth\" /\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"deferred\" marktostencil=\"true\" vertexlights=\"true\" metadata=\"gbuffer\" depthstencil=\"depth\"\u0026gt;\n        \u0026lt;output index=\"0\" name=\"specular\" /\u0026gt;\n        \u0026lt;output index=\"1\" name=\"albedo\" /\u0026gt;\n        \u0026lt;output index=\"2\" name=\"normal\" /\u0026gt;\n    \u0026lt;/command\u0026gt;\n    \u0026lt;command type=\"lightvolumes\" vs=\"PBRDeferred\" ps=\"PBRDeferred\" psdefines=\"PBRDEFERRED PBR HWDEPTH\" vsdefines=\"PBR\" output=\"viewport\" depthstencil=\"depth\"\u0026gt;\n        \u0026lt;texture unit=\"specular\" name=\"specular\" /\u0026gt;\n        \u0026lt;texture unit=\"albedo\" name=\"albedo\" /\u0026gt;\n        \u0026lt;texture unit=\"normal\" name=\"normal\" /\u0026gt;\n        \u0026lt;texture unit=\"depth\" name=\"depth\" /\u0026gt;\n    \u0026lt;/command\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"postopaque\" depthstencil=\"depth\"/\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"refract\" depthstencil=\"depth\"\u0026gt;\n        \u0026lt;texture unit=\"environment\" name=\"viewport\" /\u0026gt;\n    \u0026lt;/command\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"alpha\" vertexlights=\"true\" sort=\"backtofront\" metadata=\"alpha\" depthstencil=\"depth\" psdefines=\"HWDEPTH\"\u0026gt;\n        \u0026lt;texture unit=\"depth\" name=\"depth\" /\u0026gt;\n    \u0026lt;/command\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"postalpha\" sort=\"backtofront\" depthstencil=\"depth\" /\u0026gt;\n\u0026lt;/renderpath\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe rendering works like this :\u003cbr\u003e\n-First i render my background (The PReRendered pass above)\u003cbr\u003e\n-Then i clear the depth\u003cbr\u003e\n-Then i render the depth meshes (this pass writes only in depth map and leave all the pixel information on the screen untouched)\u003cbr\u003e\n-Finally render everything else.\u003c/p\u003e\n\u003cp\u003eMy TEchnique for depth pass only looks like this\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;technique\u0026gt;\n\t\u0026lt;pass name=\"DepthOnly\" vs=\"Depth\" ps=\"Depth\"/\u0026gt;\n\t\u0026lt;pass name=\"light\" vs=\"PBRLitSolid\" ps=\"PBRLitSolid\" psdefines=\"DIFFMAP PBR IBL\" blend=\"subtract\" /\u0026gt;\n\t\u0026lt;pass name=\"shadow\" vs=\"Shadow\" ps=\"Shadow\" /\u0026gt;\n\u0026lt;/technique\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe shadow pass is working the invisible Depth meshes cast shadows properly on regular meshes but the light pass is wrong because the depth meshes can‚Äôt receive lights nor shadows. Any idea how to fix this ? Or is it even possible ?\u003cbr\u003e\nThanks !\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2022-02-01T09:12:08.797Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":26,"readers_count":25,"score":15.2,"yours":false,"topic_id":7179,"topic_slug":"need-help-with-cusomized-pbr-renderpath","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":44570,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2022-02-01T14:24:30.285Z","cooked":"\u003cp\u003eFound the problem !!! I defined the light pass in the technique but the renderpath had no light pass defined so it never happened. Added and it works as expected.\u003c/p\u003e\n\u003cp\u003eThis is why i still think Urho3d is the best engine out there ! Easy to use , easy to expand and easy to modify.\u003cbr\u003e\nThe creativity ,experience and talent of the developers are amazing !\u003cbr\u003e\nKeep up the good work !\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2022-02-01T14:25:13.472Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":23,"readers_count":22,"score":114.6,"yours":false,"topic_id":7179,"topic_slug":"need-help-with-cusomized-pbr-renderpath","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":7}],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":44585,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2022-02-02T18:33:35.430Z","cooked":"\u003cp\u003eSome short video of this in action. The background is a 2d image and there is a floor plane that is rendered into depth map only and exists only to receive shadows. PBR looks awesome. Maybe it‚Äôs not optimized for large complex levels but in my use case with few models per segment will do the job perfectly\u003c/p\u003e\n\u003cdiv class=\"onebox lazyYT lazyYT-container\" data-youtube-id=\"C3htGfzdPy0\" data-youtube-title=\"infested pbr test\" data-parameters=\"feature=oembed\u0026amp;wmode=opaque\"\u003e\n  \u003ca href=\"https://www.youtube.com/watch?v=C3htGfzdPy0\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003e\n    \u003cimg class=\"ytp-thumbnail-image\" src=\"https://img.youtube.com/vi/C3htGfzdPy0/hqdefault.jpg\" title=\"infested pbr test\" width=\"480\" height=\"360\"\u003e\n  \u003c/a\u003e\n\u003c/div\u003e\n","post_number":3,"post_type":1,"updated_at":"2022-02-02T18:33:35.430Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":20,"readers_count":19,"score":109.0,"yours":false,"topic_id":7179,"topic_slug":"need-help-with-cusomized-pbr-renderpath","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://www.youtube.com/watch?v=C3htGfzdPy0","internal":false,"reflection":false,"title":"infested pbr test - YouTube","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":5}],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":44588,"name":"","username":"GodMan","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png","created_at":"2022-02-03T17:35:34.174Z","cooked":"\u003cp\u003e\u003ca class=\"mention\" href=\"/u/dave82\"\u003e@Dave82\u003c/a\u003e Looks great. I‚Äôve always wanted to try pbr shaders in a urho3d project. I was always under the impression that they are real demanding on your hardware, and not such great performance.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2022-02-03T17:35:34.174Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":13,"readers_count":12,"score":17.6,"yours":false,"topic_id":7179,"topic_slug":"need-help-with-cusomized-pbr-renderpath","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":861,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[44539,44570,44585,44588]},"timeline_lookup":[[1,295],[3,293],[4,292]],"suggested_topics":[{"id":7083,"title":"Using custom models in Xamarin.Forms shared project","fancy_title":"Using custom models in Xamarin.Forms shared project","slug":"using-custom-models-in-xamarin-forms-shared-project","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2021-12-03T08:34:21.895Z","last_posted_at":"2021-12-03T11:40:30.983Z","bumped":true,"bumped_at":"2021-12-03T11:40:30.983Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":198,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1493,"username":"Nikolai","name":"Nikolai Miroshnichenko","avatar_template":"/user_avatar/discourse.urho3d.io/nikolai/{size}/3632_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7097,"title":"View Physics event for ConvexCast","fancy_title":"View Physics event for ConvexCast","slug":"view-physics-event-for-convexcast","posts_count":11,"reply_count":5,"highest_post_number":11,"image_url":null,"created_at":"2021-12-09T23:56:27.507Z","last_posted_at":"2021-12-12T20:20:02.788Z","bumped":true,"bumped_at":"2021-12-12T20:20:02.788Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":206,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7087,"title":"Android how to get error message sometimes little change gives me just crash","fancy_title":"Android how to get error message sometimes little change gives me just crash","slug":"android-how-to-get-error-message-sometimes-little-change-gives-me-just-crash","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-05T16:59:59.376Z","last_posted_at":"2021-12-05T18:17:02.335Z","bumped":true,"bumped_at":"2021-12-05T18:17:02.335Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":153,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1436,"username":"Maco","name":"Maco","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/m/90ced4/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7176,"title":"Orthographic scene slowing down when zooming out","fancy_title":"Orthographic scene slowing down when zooming out","slug":"orthographic-scene-slowing-down-when-zooming-out","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-01-30T10:05:50.218Z","last_posted_at":"2022-01-30T10:05:50.294Z","bumped":true,"bumped_at":"2022-01-30T10:05:50.294Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":127,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1351,"username":"Haukinger","name":"Haukinger","avatar_template":"/user_avatar/discourse.urho3d.io/haukinger/{size}/3670_2.png"}}]},{"id":7208,"title":"ScreenSpace Y - Inverted for View3D and RTT","fancy_title":"ScreenSpace Y - Inverted for View3D and RTT","slug":"screenspace-y-inverted-for-view3d-and-rtt","posts_count":14,"reply_count":11,"highest_post_number":15,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/5/506273b200a2f3337a69438a7989218d599e587b_2_823x1024.png","created_at":"2022-02-24T23:11:35.590Z","last_posted_at":"2022-03-09T12:27:07.577Z","bumped":true,"bumped_at":"2022-03-09T12:27:07.577Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":268,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1004,"username":"GoldenThumbs","name":"Golden Thumbs","avatar_template":"/user_avatar/discourse.urho3d.io/goldenthumbs/{size}/1669_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":627,"username":"George1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/9e8a1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1335,"username":"justanotherdev","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/e8c25b/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":7179,"title":"Need help with cusomized PBR renderpath","fancy_title":"Need help with cusomized PBR renderpath","posts_count":4,"created_at":"2022-02-01T09:04:58.692Z","views":205,"reply_count":0,"like_count":13,"last_posted_at":"2022-02-03T17:35:34.174Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"need-help-with-cusomized-pbr-renderpath","category_id":10,"word_count":752,"deleted_at":null,"user_id":247,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_7179","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":2,"username":"Dave82","excerpt":"Found the problem !!! I defined the light pass in the technique but the renderpath had no light pass defined so it never happened. Added and it works as expected. \nThis is why i still think Urho3d is the best engine out there ! Easy to use , easy to expand and easy to modify. \nThe creativity ,experi\u0026hellip;"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"},"last_poster":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}}