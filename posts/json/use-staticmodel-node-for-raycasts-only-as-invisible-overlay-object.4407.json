{"post_stream":{"posts":[{"id":25389,"name":"Ahorn42","username":"ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png","created_at":"2018-07-25T16:06:20.797Z","cooked":"\u003cp\u003eHi there,\u003c/p\u003e\n\u003cp\u003eI am trying to select objects via octree raycast, which works, but the rendering performance isn‚Äôt great because of to many subobjects (StaticModel with multiple vertex buffers (~10000)). If I am rendering the combined object (one vertex buffer) the performance is okay, but the raycast can‚Äôt determine a subobject other then \u003ccode\u003e0\u003c/code\u003e, understandably.\u003c/p\u003e\n\u003cp\u003eSo my idea was: taking the one-vertex-buffer model to render the models (that‚Äôs hidden from the raycast via viewmask) and use a multiple-vertex-buffer model that‚Äôs hidden from the camera to do a raycast to determine the selected subobject.\u003c/p\u003e\n\u003cp\u003eBut if I do this the performance drops as low as if I use the multiple-vertex-buffer model for rendering.\u003cbr\u003e\nThe only noticeable performance boost was possible if I disabled the multiple-vertex-buffer model, but on a disabled node the raycast does not work either. Setting the multiple-vertex-buffer models \u003ccode\u003eViewMask\u003c/code\u003e to \u003ccode\u003e0x00000000\u003c/code\u003e or setting its \u003ccode\u003eDrawDistance\u003c/code\u003e to \u003ccode\u003e0\u003c/code\u003e or a very high value (100000) has no effect on the performance. I also tried to set the \u003ccode\u003eOcludee\u003c/code\u003e property to \u003ccode\u003etrue\u003c/code\u003e, with no noticeable impact.\u003cbr\u003e\nThat‚Äôs quite interesting in my opinion. Shouldn‚Äôt setting a models \u003ccode\u003eViewMask\u003c/code\u003e to \u003ccode\u003e0x00000000\u003c/code\u003e prevent it from rendering, because it‚Äôs invisible for the cameras? But it seems as the vertex buffers still get transferred to the graphics card and causing some performance trouble there. I can not imagine that the raycast hits the performance so hard.\u003c/p\u003e\n\u003cp\u003eAre there any ideas out there, how to prevent a StaticModel from rendering? (Or an other idea how to perform the model selection?)\u003c/p\u003e\n\u003cp\u003eTwo ideas I still have are:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eloading the submodels as CollisionShapes and perform a physics raycast (but I think the physics engine will die with that many objects),\u003c/li\u003e\n\u003cli\u003ecreating a color coded texture and select the object according to the color at the position where the raycast hits the texture (the problem here is to unwrap the model(s) in blender, because they are very large with high polygon count (~500000 all together) and not easy to unwrap).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003ebest regards,\u003cbr\u003e\nahorn42\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2018-07-25T16:06:20.797Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":80,"reads":42,"readers_count":41,"score":413.4,"yours":false,"topic_id":4407,"topic_slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","display_username":"Ahorn42","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1011,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":25390,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2018-07-25T22:23:10.822Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"ahorn42\" data-post=\"1\" data-topic=\"4407\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/40.png\" class=\"avatar\"\u003e ahorn42:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eShouldn‚Äôt setting a models \u003ccode\u003eViewMask\u003c/code\u003e to \u003ccode\u003e0x00000000\u003c/code\u003e prevent it from rendering, because it‚Äôs invisible for the cameras?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003e\u003ccode\u003eModel\u003c/code\u003e (and so, \u003ccode\u003eVertexBuffer\u003c/code\u003e and \u003ccode\u003eIndexBuffer\u003c/code\u003e) is always created in GPU memory.\u003cbr\u003e\nHowever, model with zero view mask shall not be rendered.\u003cbr\u003e\nAre you sure that your multiple-vertex-buffer model is not rendered?\u003cbr\u003e\nEnsure that you don‚Äôt use this model as occlud\u003cstrong\u003eer\u003c/strong\u003e.\u003c/p\u003e\n\u003caside class=\"quote no-group\" data-username=\"ahorn42\" data-post=\"1\" data-topic=\"4407\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/40.png\" class=\"avatar\"\u003e ahorn42:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe only noticeable performance boost was possible if I disabled the multiple-vertex-buffer model, but on a disabled node the raycast does not work either.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eIf you have known set of Drawable-s to ray test, nothing prevents you from calling \u003ccode\u003eProcessRayQuery\u003c/code\u003e manually. It doesn‚Äôt care about enabling things.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-07-25T22:23:10.822Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":2,"reads":38,"readers_count":37,"score":22.6,"yours":false,"topic_id":4407,"topic_slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":25396,"name":"Ahorn42","username":"ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png","created_at":"2018-07-26T11:11:47.528Z","cooked":"\u003cp\u003eI really like the idea to call ProcessRayQuery manually on an disabled object - I‚Äôll try that, but as I am using UrhoSharp I need to extend some of the bindings, because not all public members and types are redirected. So it might take some time, till I can tell if it is working as intended.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-07-26T11:11:47.528Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":3,"reads":34,"readers_count":33,"score":26.8,"yours":false,"topic_id":4407,"topic_slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","display_username":"Ahorn42","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1011,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":25397,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2018-07-26T11:25:48.186Z","cooked":"\u003cp\u003eBTW, what if you put your raycast model into second invisible scene and then use that scene for querying?\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2018-07-26T11:26:04.432Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":8,"reads":33,"readers_count":32,"score":46.6,"yours":false,"topic_id":4407,"topic_slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"reply_to_user":{"username":"ahorn42","name":"Ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":25603,"name":"Ahorn42","username":"ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png","created_at":"2018-08-10T07:55:10.685Z","cooked":"\u003cp\u003eyeahy - I finaly got it, but with an slightly different aproach.\u003c/p\u003e\n\u003cp\u003eAt first I tried to get the \u003ccode\u003eProcessRayQuery\u003c/code\u003e method working in C#, but I failed on some C++ difficulties I think. But during testing I recognized, that another problem was the time the raycast takes on such a large object. And this would not get much better, by calling \u003ccode\u003eProcessRayQuery\u003c/code\u003e manually.\u003c/p\u003e\n\u003cp\u003eMy aproach now is to use a second \u003ccode\u003eOctree\u003c/code\u003e where I add the segmentized subobjects of the large object in smaller single objects (about 6000). I disable them, so they don‚Äôt get used by the renderer and added them manually via \u003ccode\u003eAddManualDrawable\u003c/code\u003e to my own octree.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003emyOct = new Octree();\nfor (int i = 0; i \u0026lt;= x; i++) {\n    var raycastSubObjectModel = raycastSubObject.CreateComponent\u0026lt;StaticModel\u0026gt;();\n    raycastSubObjectModel.Model = ResourceCache.GetModel(\"Models/\" + i + \".mdl\");\n    raycastSubObjectModel.Enabled = false;\n    myOct.AddManualDrawable(raycastSubObjectModel);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe perfomance increased very well from about 50 to 120ms per raycast down to below 2ms per raycast \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca class=\"mention\" href=\"/u/eugene\"\u003e@Eugene\u003c/a\u003e thanks for your ideas otherwise I wouldn‚Äôt have found my current solution \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/wink.png?v=5\" title=\":wink:\" class=\"emoji\" alt=\":wink:\"\u003e\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2018-08-10T07:55:48.431Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":4,"reads":27,"readers_count":26,"score":40.4,"yours":false,"topic_id":4407,"topic_slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","display_username":"Ahorn42","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1011,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true}],"stream":[25389,25390,25396,25397,25603]},"timeline_lookup":[[1,1582],[2,1581],[5,1566]],"suggested_topics":[{"id":7080,"title":"Build urho3d source on windows 10 - cmake - \"Error in configuration process, project files may be invalid\"","fancy_title":"Build urho3d source on windows 10 - cmake - \u0026ldquo;Error in configuration process, project files may be invalid\u0026rdquo;","slug":"build-urho3d-source-on-windows-10-cmake-error-in-configuration-process-project-files-may-be-invalid","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2021-12-03T01:55:53.267Z","last_posted_at":"2021-12-06T22:46:59.584Z","bumped":true,"bumped_at":"2021-12-06T22:46:59.584Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":324,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7086,"title":"Handling CrowdAgents that get stuck","fancy_title":"Handling CrowdAgents that get stuck","slug":"handling-crowdagents-that-get-stuck","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-04T01:26:23.062Z","last_posted_at":"2021-12-05T04:37:54.143Z","bumped":true,"bumped_at":"2021-12-05T04:37:54.143Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7132,"title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","fancy_title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","slug":"how-to-draw-anti-aliased-outlined-line-on-the-ui-layer","posts_count":8,"reply_count":5,"highest_post_number":8,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c040fdbc2f1856c238ba6328fd7f5ff80b15858f_2_782x1024.jpeg","created_at":"2022-01-17T22:08:06.874Z","last_posted_at":"2022-01-20T20:13:30.614Z","bumped":true,"bumped_at":"2022-01-20T20:13:30.614Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":173,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7178,"title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","fancy_title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","slug":"medium-quality-technique-for-semi-reflective-specular-glass-in-urho","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/51408fe152ba02eb8b92237cc9a9411c8ee922e6.jpeg","created_at":"2022-01-31T22:57:50.134Z","last_posted_at":"2022-02-01T04:32:37.418Z","bumped":true,"bumped_at":"2022-02-01T04:32:37.418Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":154,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":4407,"title":"Use StaticModel/Node for raycasts only (as invisible overlay/object)","fancy_title":"Use StaticModel/Node for raycasts only (as invisible overlay/object)","posts_count":5,"created_at":"2018-07-25T16:06:20.724Z","views":647,"reply_count":2,"like_count":1,"last_posted_at":"2018-08-10T07:55:10.685Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"use-staticmodel-node-for-raycasts-only-as-invisible-overlay-object","category_id":10,"word_count":728,"deleted_at":null,"user_id":1011,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_4407","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":5,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":5,"username":"ahorn42","excerpt":"yeahy - I finaly got it, but with an slightly different aproach. \nAt first I tried to get the ProcessRayQuery method working in C#, but I failed on some C++ difficulties I think. But during testing I recognized, that another problem was the time the raycast takes on such a large object. And this wou\u0026hellip;"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1011,"username":"ahorn42","name":"Ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1011,"username":"ahorn42","name":"Ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png"},"last_poster":{"id":1011,"username":"ahorn42","name":"Ahorn42","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/97f17d/{size}.png"}}}