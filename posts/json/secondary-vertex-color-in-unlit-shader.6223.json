{"post_stream":{"posts":[{"id":38008,"name":"Teknologicus","username":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png","created_at":"2020-06-24T20:33:55.796Z","cooked":"\u003cp\u003eIn my cubic voxel surfaces project I want to make sunlight transition (day to night and vice versa) work via a sunlight level scalar shader uniform.  Each vertex will also have a secondary color for the sunlight (in addition to the torchlight (first) vertex color already working).\u003c/p\u003e\n\u003cp\u003eMy understanding of techniques and shaders is rudimentary and I‚Äôm looking for some helpful/insightful direction on how to go about this.  If someone has relevant code in an open source Urho3D project accessible online, please point me to it so I can study the relevant code.\u003c/p\u003e\n\u003cp\u003eThis is the ‚ÄúDiffUnlitVCol.xml‚Äù technique (credit \u003ca class=\"mention\" href=\"/u/tinimini\"\u003e@Tinimini\u003c/a\u003e) I‚Äôm using:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u0026lt;technique vs=‚ÄúUnlit‚Äù ps=‚ÄúUnlit‚Äù vsdefines=‚ÄúVERTEXCOLOR‚Äù psdefines=‚ÄúDIFFMAP VERTEXCOLOR‚Äù\u0026gt;\u003cbr\u003e\n\u0026lt;pass name=‚Äúbase‚Äù /\u0026gt;\u003cbr\u003e\n\u0026lt;pass name=‚Äúprepass‚Äù psdefines=‚ÄúPREPASS‚Äù /\u0026gt;\u003cbr\u003e\n\u0026lt;pass name=‚Äúmaterial‚Äù /\u0026gt;\u003cbr\u003e\n\u0026lt;pass name=‚Äúdeferred‚Äù psdefines=‚ÄúDEFERRED‚Äù /\u0026gt;\u003cbr\u003e\n\u0026lt;/technique\u0026gt;\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eDo I need to change/add anything in this technique for it to be able to pass the secondary color from the vertex buffer object to the shader as well as expose the sunlight scalar shader uniform?  Furthermore, do I need to make modifications to a copy of the ‚ÄúUnlit.glsl‚Äù shader?  It looks to me like ‚ÄúUnlit.glsl‚Äù only makes use of one vertex color (VERTEXCOLOR) and I‚Äôm unclear how I would make it access the uniform for scaling the secondary vertex color (sunlight).\u003c/p\u003e\n\u003cp\u003eKind regards,\u003cbr\u003e\nTeknologicus\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2020-06-24T20:41:31.623Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":4,"reads":36,"readers_count":35,"score":27.2,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"Teknologicus","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1063,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":39153,"name":"Teknologicus","username":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png","created_at":"2020-10-05T00:57:41.300Z","cooked":"\u003cp\u003eI‚Äôve made some progress on this in that I understand Urho3D only supports one color per vertex, whereas I need three colors per vertex (sun, torch and anti-light).  I decided to make some experimental changes to a copy of Urho3D source code to see if I could get it to support multiple colors per vertex with vertex buffers.\u003c/p\u003e\n\u003cp\u003eWhat I‚Äôm looking for is feedback as to whether I‚Äôm going down the right path or not.\u003c/p\u003e\n\u003cp\u003eHere‚Äôs what I changed in a copy of Urho3D source code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ediff -r -U3 /tmp/Urho3D-master/Source/Urho3D/Graphics/GraphicsDefs.cpp ./Source/Urho3D/Graphics/GraphicsDefs.cpp\n--- /tmp/Urho3D-master/Source/Urho3D/Graphics/GraphicsDefs.cpp\t2020-07-27 06:31:27.000000000 -0700\n+++ ./Source/Urho3D/Graphics/GraphicsDefs.cpp\t2020-10-04 16:01:29.154308332 -0700\n@@ -97,6 +97,8 @@\n    VertexElement(TYPE_VECTOR3, SEM_POSITION, 0, false),     // Position\n    VertexElement(TYPE_VECTOR3, SEM_NORMAL, 0, false),       // Normal\n    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color2\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color3\n    VertexElement(TYPE_VECTOR2, SEM_TEXCOORD, 0, false),     // Texcoord1\n    VertexElement(TYPE_VECTOR2, SEM_TEXCOORD, 1, false),     // Texcoord2\n    VertexElement(TYPE_VECTOR3, SEM_TEXCOORD, 0, false),     // Cubetexcoord1\ndiff -r -U3 /tmp/Urho3D-master/Source/Urho3D/Graphics/GraphicsDefs.h ./Source/Urho3D/Graphics/GraphicsDefs.h\n--- /tmp/Urho3D-master/Source/Urho3D/Graphics/GraphicsDefs.h\t2020-07-27 06:31:27.000000000 -0700\n+++ ./Source/Urho3D/Graphics/GraphicsDefs.h\t2020-10-04 14:23:35.474301914 -0700\n@@ -136,6 +136,8 @@\n    ELEMENT_POSITION = 0,\n    ELEMENT_NORMAL,\n    ELEMENT_COLOR,\n+    ELEMENT_COLOR2,\n+    ELEMENT_COLOR3,\n    ELEMENT_TEXCOORD1,\n    ELEMENT_TEXCOORD2,\n    ELEMENT_CUBETEXCOORD1,\n@@ -452,21 +454,23 @@\n// Legacy vertex element bitmasks.\nenum VertexMask : unsigned\n{\n-    MASK_NONE = 0x0,\n-    MASK_POSITION = 0x1,\n-    MASK_NORMAL = 0x2,\n-    MASK_COLOR = 0x4,\n-    MASK_TEXCOORD1 = 0x8,\n-    MASK_TEXCOORD2 = 0x10,\n-    MASK_CUBETEXCOORD1 = 0x20,\n-    MASK_CUBETEXCOORD2 = 0x40,\n-    MASK_TANGENT = 0x80,\n-    MASK_BLENDWEIGHTS = 0x100,\n-    MASK_BLENDINDICES = 0x200,\n-    MASK_INSTANCEMATRIX1 = 0x400,\n-    MASK_INSTANCEMATRIX2 = 0x800,\n-    MASK_INSTANCEMATRIX3 = 0x1000,\n-    MASK_OBJECTINDEX = 0x2000,\n+    MASK_NONE            = 0x0000,\n+    MASK_POSITION        = 0x0001,\n+    MASK_NORMAL          = 0x0002,\n+    MASK_COLOR           = 0x0004,\n+    MASK_COLOR2          = 0x0008,\n+    MASK_COLOR3          = 0x0010,\n+    MASK_TEXCOORD1       = 0x0020,\n+    MASK_TEXCOORD2       = 0x0040,\n+    MASK_CUBETEXCOORD1   = 0x0080,\n+    MASK_CUBETEXCOORD2   = 0x0100,\n+    MASK_TANGENT         = 0x0200,\n+    MASK_BLENDWEIGHTS    = 0x0400,\n+    MASK_BLENDINDICES    = 0x0800,\n+    MASK_INSTANCEMATRIX1 = 0x1000,\n+    MASK_INSTANCEMATRIX2 = 0x2000,\n+    MASK_INSTANCEMATRIX3 = 0x4000,\n+    MASK_OBJECTINDEX     = 0x8000\n};\nURHO3D_FLAGSET(VertexMask, VertexMaskFlags);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn a copy of bin/CoreData/Shaders/GLSL/Transform.glsl called TransformC3.glsl, I‚Äôve done this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e--- bin/CoreData/Shaders/GLSL/Transform.glsl    2018-10-28 08:20:42.000000000 -0700\n+++ bin/CoreData/Shaders/GLSL/TransformC3.glsl  2020-10-04 14:28:03.170968864 -0700\n@@ -9,6 +9,8 @@\nattribute vec4 iPos;\nattribute vec3 iNormal;\nattribute vec4 iColor;\n+attribute vec4 iColor2;\n+attribute vec4 iColor3;\nattribute vec2 iTexCoord;\nattribute vec2 iTexCoord1;\nattribute vec4 iTangent;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn a copy of bin/CoreData/Shaders/GLSL/Unlit.glsl called UnlitC3.glsl, I‚Äôve done this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e--- bin/CoreData/Shaders/GLSL/Unlit.glsl        2018-10-28 08:20:42.000000000 -0700\n+++ bin/CoreData/Shaders/GLSL/UnlitC3.glsl      2020-10-04 17:24:30.407646913 -0700\n@@ -1,6 +1,6 @@\n#include \"Uniforms.glsl\"\n#include \"Samplers.glsl\"\n-#include \"Transform.glsl\"\n+#include \"TransformC3.glsl\"\n#include \"ScreenPos.glsl\"\n#include \"Fog.glsl\"\n\n@@ -8,6 +8,8 @@\nvarying vec4 vWorldPos;\n#ifdef VERTEXCOLOR\n    varying vec4 vColor;\n+    varying vec4 vColor2;\n+    varying vec4 vColor3;\n#endif\n\nvoid VS()\n@@ -20,8 +22,9 @@\n\n    #ifdef VERTEXCOLOR\n        vColor = iColor;\n+        vColor2 = iColor2;\n+        vColor3 = iColor3;\n    #endif\n-\n}\n\nvoid PS()\n@@ -38,6 +41,7 @@\n    #endif\n\n    #ifdef VERTEXCOLOR\n+        // mix together multiple colors here\n        diffColor *= vColor;\n    #endif\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI‚Äôve defined a technique called DiffUnlitVCol3.xml as follows which utilizes the shader:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026lt;technique vs=\"UnlitC3\" ps=\"UnlitC3\" vsdefines=\"VERTEXCOLOR\" psdefines=\"DIFFMAP VERTEXCOLOR\"\u0026gt;\n    \u0026lt;pass name=\"base\" /\u0026gt;\n\u0026lt;/technique\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd a material called VoxelsAtlas.xml which utilizes the technique:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026lt;material\u0026gt;\n    \u0026lt;technique name=\"Techniques/DiffUnlitVCol3.xml\" /\u0026gt;\n    \u0026lt;texture unit=\"diffuse\" name=\"Textures/VoxelsAtlas.dds\" /\u0026gt;\n\u0026lt;/material\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn my C++ application code I create a model using a vertex buffer with three colors per vertex and add it as a node to the scene.  In the PS function, in the shader UnlitC3.glsl, if I code ‚ÄúdiffColor *= vColor;‚Äù I get what I would expect, but if I instead use ‚ÄúdiffColor *= vColor2;‚Äù I get results which look like vec4 colors that are uninitialized (mainly the color black with some weird colors here and there).  I‚Äôve verified the vertex buffer data is being filled in correctly on the application side, so I‚Äôm unsure what I‚Äôm most likely doing wrong in the Urho3D code changes.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2020-10-05T01:23:50.473Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":29,"readers_count":28,"score":10.8,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"Teknologicus","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1063,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":39155,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2020-10-05T10:09:08.622Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"Teknologicus\" data-post=\"2\" data-topic=\"6223\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/teknologicus/40/2646_2.png\" class=\"avatar\"\u003e Teknologicus:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color2\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color3\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eMy best bet is on these lines. You don‚Äôt have 3 color attributes, you have 3 declarations of the same color attribute.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2020-10-06T06:55:48.874Z","reply_count":1,"reply_to_post_number":2,"quote_count":1,"incoming_link_count":0,"reads":25,"readers_count":24,"score":25.0,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":39159,"name":"Teknologicus","username":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png","created_at":"2020-10-05T19:55:37.224Z","cooked":"\u003cp\u003eThank you.  Yes, indeed!  It should be:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 1, false),    // Color2\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 2, false),    // Color3\u003c/code\u003e\u003c/pre\u003e","post_number":4,"post_type":1,"updated_at":"2020-10-05T19:55:37.224Z","reply_count":1,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":0,"reads":25,"readers_count":24,"score":10.0,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"Teknologicus","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1063,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":39162,"name":"Teknologicus","username":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png","created_at":"2020-10-06T20:58:52.136Z","cooked":"\u003cp\u003eUpdate:  It turned out I only needed two colors per vertex to achieve day/night sunlight transitions.  Here‚Äôs what I had to change in the Urho3D source code and GLSL shaders:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ediff -r -U3 Urho3D-orig/Source/Urho3D/Graphics/GraphicsDefs.cpp Urho3D/Source/Urho3D/Graphics/GraphicsDefs.cpp\n--- Urho3D-orig/Source/Urho3D/Graphics/GraphicsDefs.cpp\t2020-07-27 06:31:27.000000000 -0700\n+++ Urho3D/Source/Urho3D/Graphics/GraphicsDefs.cpp\t2020-10-06 10:50:39.864288705 -0700\n@@ -97,6 +97,7 @@\n    VertexElement(TYPE_VECTOR3, SEM_POSITION, 0, false),     // Position\n    VertexElement(TYPE_VECTOR3, SEM_NORMAL, 0, false),       // Normal\n    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 0, false),    // Color\n+    VertexElement(TYPE_UBYTE4_NORM, SEM_COLOR, 1, false),    // Color2\n    VertexElement(TYPE_VECTOR2, SEM_TEXCOORD, 0, false),     // Texcoord1\n    VertexElement(TYPE_VECTOR2, SEM_TEXCOORD, 1, false),     // Texcoord2\n    VertexElement(TYPE_VECTOR3, SEM_TEXCOORD, 0, false),     // Cubetexcoord1\ndiff -r -U3 Urho3D-orig/Source/Urho3D/Graphics/GraphicsDefs.h Urho3D/Source/Urho3D/Graphics/GraphicsDefs.h\n--- Urho3D-orig/Source/Urho3D/Graphics/GraphicsDefs.h\t2020-07-27 06:31:27.000000000 -0700\n+++ Urho3D/Source/Urho3D/Graphics/GraphicsDefs.h\t2020-10-06 10:50:28.364288693 -0700\n@@ -136,6 +136,7 @@\n    ELEMENT_POSITION = 0,\n    ELEMENT_NORMAL,\n    ELEMENT_COLOR,\n+    ELEMENT_COLOR2,\n    ELEMENT_TEXCOORD1,\n    ELEMENT_TEXCOORD2,\n    ELEMENT_CUBETEXCOORD1,\n@@ -452,21 +453,22 @@\n// Legacy vertex element bitmasks.\nenum VertexMask : unsigned\n{\n-    MASK_NONE = 0x0,\n-    MASK_POSITION = 0x1,\n-    MASK_NORMAL = 0x2,\n-    MASK_COLOR = 0x4,\n-    MASK_TEXCOORD1 = 0x8,\n-    MASK_TEXCOORD2 = 0x10,\n-    MASK_CUBETEXCOORD1 = 0x20,\n-    MASK_CUBETEXCOORD2 = 0x40,\n-    MASK_TANGENT = 0x80,\n-    MASK_BLENDWEIGHTS = 0x100,\n-    MASK_BLENDINDICES = 0x200,\n-    MASK_INSTANCEMATRIX1 = 0x400,\n-    MASK_INSTANCEMATRIX2 = 0x800,\n-    MASK_INSTANCEMATRIX3 = 0x1000,\n-    MASK_OBJECTINDEX = 0x2000,\n+    MASK_NONE            = 0x0000,\n+    MASK_POSITION        = 0x0001,\n+    MASK_NORMAL          = 0x0002,\n+    MASK_COLOR           = 0x0004,\n+    MASK_COLOR2          = 0x0008,\n+    MASK_TEXCOORD1       = 0x0010,\n+    MASK_TEXCOORD2       = 0x0020,\n+    MASK_CUBETEXCOORD1   = 0x0040,\n+    MASK_CUBETEXCOORD2   = 0x0080,\n+    MASK_TANGENT         = 0x0100,\n+    MASK_BLENDWEIGHTS    = 0x0200,\n+    MASK_BLENDINDICES    = 0x0400,\n+    MASK_INSTANCEMATRIX1 = 0x0800,\n+    MASK_INSTANCEMATRIX2 = 0x1000,\n+    MASK_INSTANCEMATRIX3 = 0x2000,\n+    MASK_OBJECTINDEX     = 0x4000\n};\nURHO3D_FLAGSET(VertexMask, VertexMaskFlags);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTransform.glsl:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e--- bin/CoreData/Shaders/GLSL/Transform~.glsl\t2020-10-06 13:05:07.610963219 -0700\n+++ bin/CoreData/Shaders/GLSL/Transform.glsl\t2020-10-06 10:44:42.510955016 -0700\n@@ -9,6 +9,7 @@\nattribute vec4 iPos;\nattribute vec3 iNormal;\nattribute vec4 iColor;\n+attribute vec4 iColor1;\nattribute vec2 iTexCoord;\nattribute vec2 iTexCoord1;\nattribute vec4 iTangent;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUnlit.glsl copied to UnlitC2.glsl with added uniform for sunlight level:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e--- bin/CoreData/Shaders/GLSL/Unlit.glsl\t2018-10-28 08:20:42.000000000 -0700\n+++ bin/CoreData/Shaders/GLSL/UnlitC2.glsl\t2020-10-06 12:33:46.287628103 -0700\n@@ -4,10 +4,13 @@\n#include \"ScreenPos.glsl\"\n#include \"Fog.glsl\"\n\n+uniform vec3 cSunlightLevel;\n+\nvarying vec2 vTexCoord;\nvarying vec4 vWorldPos;\n#ifdef VERTEXCOLOR\n    varying vec4 vColor;\n+    varying vec4 vColor1;\n#endif\n\nvoid VS()\n@@ -20,8 +23,8 @@\n\n    #ifdef VERTEXCOLOR\n        vColor = iColor;\n+        vColor1 = iColor1;\n    #endif\n-\n}\n\nvoid PS()\n@@ -38,7 +41,17 @@\n    #endif\n\n    #ifdef VERTEXCOLOR\n-        diffColor *= vColor;\n+        vec4 sun   = vColor,\n+             torch = vColor1,\n+             color;\n+        sun.r *= cSunlightLevel.r;\n+        sun.g *= cSunlightLevel.g;\n+        sun.b *= cSunlightLevel.b;\n+        color.r = sun.r \u0026gt; torch.r ? sun.r : torch.r;\n+        color.g = sun.g \u0026gt; torch.g ? sun.g : torch.g;\n+        color.b = sun.b \u0026gt; torch.b ? sun.b : torch.b;\n+        color.a = 1.0;\n+        diffColor *= color;\n    #endif\n\n    // Get fog factor\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"onebox lazyYT lazyYT-container\" data-youtube-id=\"6y3sRwfXQv0\" data-youtube-title=\"Cubic Voxel Surfaces with Urho3D - day / night sunlight level transition via GLSL shader.\" data-parameters=\"feature=oembed\u0026amp;wmode=opaque\"\u003e\n  \u003ca href=\"https://www.youtube.com/watch?v=6y3sRwfXQv0\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003e\n    \u003cimg class=\"ytp-thumbnail-image\" src=\"https://i.ytimg.com/vi/6y3sRwfXQv0/maxresdefault.jpg\" title=\"Cubic Voxel Surfaces with Urho3D - day / night sunlight level transition via GLSL shader.\" width=\"480\" height=\"360\"\u003e\n  \u003c/a\u003e\n\u003c/div\u003e\n","post_number":5,"post_type":1,"updated_at":"2020-10-06T20:58:52.136Z","reply_count":1,"reply_to_post_number":4,"quote_count":0,"incoming_link_count":0,"reads":25,"readers_count":24,"score":100.0,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"Teknologicus","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://www.youtube.com/watch?v=6y3sRwfXQv0","internal":false,"reflection":false,"title":"Cubic Voxel Surfaces with Urho3D - day / night sunlight level transition via GLSL shader. - YouTube","clicks":0}],"read":true,"user_title":null,"reply_to_user":{"username":"Teknologicus","name":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":4}],"moderator":false,"admin":false,"staff":false,"user_id":1063,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":39163,"name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","username":"Modanung","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","created_at":"2020-10-07T07:15:29.130Z","cooked":"\u003cp\u003eWow, it‚Äôs like the Efteling.\u003c/p\u003e\n\u003cdetails\u003e\n\u003csummary\u003e\n\u003c/summary\u003e\n\u003cp\u003e\u003cdiv class=\"lightbox-wrapper\"\u003e\u003ca class=\"lightbox\" href=\"https://static.thousandwonders.net/Efteling.original.4346.jpg\" title=\"\"\u003e\u003cimg src=\"https://static.thousandwonders.net/Efteling.original.4346.jpg\" alt=\"\" width=\"690\" height=\"458\"\u003e\u003cdiv class=\"meta\"\u003e\u003csvg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#far-image\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003cspan class=\"filename\"\u003e\u003c/span\u003e\u003cspan class=\"informations\"\u003e2048√ó1360\u003c/span\u003e\u003csvg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#discourse-expand\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/div\u003e\u003c/a\u003e\u003c/div\u003e\u003c/p\u003e\n\u003c/details\u003e","post_number":6,"post_type":1,"updated_at":"2020-10-07T07:15:29.130Z","reply_count":0,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":0,"reads":23,"readers_count":22,"score":19.6,"yours":false,"topic_id":6223,"topic_slug":"secondary-vertex-color-in-unlit-shader","display_username":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://static.thousandwonders.net/Efteling.original.4346.jpg","internal":false,"reflection":false,"title":"Efteling.original.4346.jpg","clicks":0}],"read":true,"user_title":"","reply_to_user":{"username":"Teknologicus","name":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":192,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[38008,39153,39155,39159,39162,39163]},"timeline_lookup":[[1,881],[2,779],[4,778],[5,777]],"suggested_topics":[{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7112,"title":"What is the proper way to add more source files(.cpp and .h) to a project?","fancy_title":"What is the proper way to add more source files(.cpp and .h) to a project?","slug":"what-is-the-proper-way-to-add-more-source-files-cpp-and-h-to-a-project","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2021-12-27T18:18:21.946Z","last_posted_at":"2021-12-28T12:19:43.514Z","bumped":true,"bumped_at":"2021-12-28T12:19:43.514Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":195,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1498,"username":"Tryout","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/85f322/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7105,"title":"Multiple Application.UI Roots?","fancy_title":"Multiple Application.UI Roots?","slug":"multiple-application-ui-roots","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/7/74b10ce575f1b69fe43be4abcb07605d74a1d27c_2_1024x544.jpeg","created_at":"2021-12-20T08:55:14.707Z","last_posted_at":"2021-12-22T02:33:05.795Z","bumped":true,"bumped_at":"2021-12-22T02:33:05.795Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":243,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7181,"title":"StaticModelGroup - Are ShaderParameters Shared?","fancy_title":"StaticModelGroup - Are ShaderParameters Shared?","slug":"staticmodelgroup-are-shaderparameters-shared","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-02-02T09:31:19.658Z","last_posted_at":"2022-02-02T17:06:24.059Z","bumped":true,"bumped_at":"2022-02-02T17:06:24.059Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":120,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7200,"title":"Urho3D just building if I check \"use SHARED libraries\"","fancy_title":"Urho3D just building if I check \u0026ldquo;use SHARED libraries\u0026rdquo;","slug":"urho3d-just-building-if-i-check-use-shared-libraries","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-02-22T20:02:48.835Z","last_posted_at":"2022-02-23T15:38:33.698Z","bumped":true,"bumped_at":"2022-02-23T15:54:07.879Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":165,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]}],"tags_descriptions":{},"id":6223,"title":"Secondary vertex color in unlit shader","fancy_title":"Secondary vertex color in unlit shader","posts_count":6,"created_at":"2020-06-24T20:33:55.721Z","views":398,"reply_count":4,"like_count":6,"last_posted_at":"2020-10-07T07:15:29.130Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"secondary-vertex-color-in-unlit-shader","category_id":10,"word_count":1451,"deleted_at":null,"user_id":1063,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6223","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":6,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":3,"username":"Eugene","excerpt":"My best bet is on these lines. You don‚Äôt have 3 color attributes, you have 3 declarations of the same color attribute."},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1063,"username":"Teknologicus","name":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":0},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1063,"username":"Teknologicus","name":"Teknologicus","avatar_template":"/user_avatar/discourse.urho3d.io/teknologicus/{size}/2646_2.png"},"last_poster":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}}