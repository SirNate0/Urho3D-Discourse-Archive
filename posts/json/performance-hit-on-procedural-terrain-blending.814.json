{"post_stream":{"posts":[{"id":4465,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2015-02-01T15:47:52.000Z","cooked":"\u003cp\u003eI‚Äôve been working on a \u003ca href=\"http://discourse.urho3d.io/t/terrain-editor/765/1\" data-bbcode=\"true\"\u003eterrain editor\u003c/a\u003e in my spare time, and I‚Äôve been noticing a bit of a performance snag. I‚Äôve implemented the ability to script certain filters that can modify the heightmap or the blend texture, including filters to randomly locate terrain blending based on noise fractals, filters to place roads etc‚Ä¶ But I have noticed that the more I use filters that modify the blend map, the worse my performance degrades. For example, when I first start the application, I get decent performance: \u003ca href=\"http://i.imgur.com/XFJi03P.jpg\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003escreenshot\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eWhen I run a \u003ca href=\"https://github.com/JTippetts/U3DTerrainEditor/blob/master/Bin/TerrainEditFilters/dirtgrass.lua\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003efractal filter\u003c/a\u003e that iterates the blend image and sets the pixels of the blend, then calls \u003cspan class=\"bbcode-b\"\u003eblendtex:SetData(blend)\u003c/span\u003e to upload the edited texture, the framerate drops noticeably: \u003ca href=\"http://i.imgur.com/EoXEHwY.jpg\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003escreenshot\u003c/a\u003e. Doing further operations such as building an elevation map and adding a road drop it even further: \u003ca href=\"http://i.imgur.com/9XJOUDy.jpg\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003escreenshot\u003c/a\u003e. (Note that the heightmap, while it has a miniscule effect, is nowhere near as drastic as modifying the blend map.) If I quicksave the heightmap and blendmap, exit the application and restart, then load the quicksaves, I get a lot of performance back: \u003ca href=\"http://i.imgur.com/6E4E6H0.jpg\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003escreenshot\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eSo I‚Äôm wondering if I‚Äôm handling the process of modifying and updating the blend texture sub-optimally. My standard technique is to modify the texture, or part of a texture, directly into the image then upload the image via Texture2D::SetData(). But I wonder if I somehow miss a crucial step, perhaps related to detail levels or to discarding old texture data or something of that nature.\u003c/p\u003e\n\u003cp\u003ePossibly related, when I create the texture for the blend map I initially call SetSize(0,0,0,TEXTURE_DYNAMIC) in order to specify dynamic usage, as I did not see anywhere to specify the usage otherwise. However, according to the comments, using sizes of 0 causes the texture size to follow the application window size. Then, when SetData is called, the texture is resized again.\u003c/p\u003e\n\u003cp\u003eI am using a 64-bit Mingw-w64 build with LuaJIT and Direct3D.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:03:05.663Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":20,"reads":6,"readers_count":5,"score":101.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/XFJi03P.jpg","internal":false,"reflection":false,"title":"XFJi03P.jpg","clicks":3},{"url":"https://github.com/JTippetts/U3DTerrainEditor/blob/master/Bin/TerrainEditFilters/dirtgrass.lua","internal":false,"reflection":false,"clicks":1},{"url":"http://i.imgur.com/6E4E6H0.jpg","internal":false,"reflection":false,"title":"6E4E6H0.jpg","clicks":0},{"url":"http://i.imgur.com/EoXEHwY.jpg","internal":false,"reflection":false,"title":"EoXEHwY.jpg","clicks":0},{"url":"http://i.imgur.com/9XJOUDy.jpg","internal":false,"reflection":false,"title":"9XJOUDy.jpg","clicks":0},{"url":"http://discourse.urho3d.io/t/u3d-terrain-editor/765","internal":true,"reflection":false,"title":"U3D Terrain Editor","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4466,"name":"Lasse √ñ√∂rni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-02-01T15:57:34.000Z","cooked":"\u003cp\u003eLooking at the profiling blocks it doesn‚Äôt seem like anything in Urho‚Äôs native view update \u0026amp; rendering is slowing down, but there‚Äôs something outside it that is taking a huge chunk of time. Maybe Lua garbage collection?\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:03:05.749Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"Lasse √ñ√∂rni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4468,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2015-02-01T17:04:52.000Z","cooked":"\u003cp\u003eI thought it might be the garbage collector, but inserting a \u003cspan class=\"bbcode-b\"\u003ecollectgarbage()\u003c/span\u003e call for a full gc cycle at the end of the filter doesn‚Äôt help. However, after you pointed out that it doesn‚Äôt seem to be in the render code, I started to dig deeper. I‚Äôve built a dummy filter as a minimal example that demonstrates the slowdown:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003ereturn\n{\n\tname=\"Dummy Loop\",\n\tdescription=\"Create a mottled dirt/grass terrain.\",\n\toptions=\n\t{\n\t\t{name=\"Frequency\", type=\"value\", value=8},\n\t\t{name=\"Num Octaves\", type=\"value\", value=6},\n\t\t{name=\"Gain\", type=\"value\", value=0.8},\n\t\t{name=\"Seed\", type=\"value\", value=12345},\n\t\t{name=\"Use Mask?\", type=\"flag\", value=false},\n\t},\n\t\n\texecute=function(self)\n\t\tlocal hw,hh=blend:GetWidth(),blend:GetHeight()\n\t\tlocal x,y\n\t\t\n\t\tfor x=0,hw-1,1 do\n\t\t\tfor y=0,hh-1,1 do\n\t\t\t\tlocal nx=x/hw\n\t\t\t\tlocal ny=y/hh\n\t\t\t\tlocal val=0.5\n\t\t\t\tlocal col=Color(1,0,0,0):Lerp(Color(0,1,0,0), val)\n\t\t\tend\n\t\tend\n\t\tcollectgarbage()\n\tend,\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eGiven that all of the texture manipulation stuff is stripped out, the error is definitely not in the texture stuff. This minimal example makes me believe that it does, in fact, lie in how Lua generates and collects garbage, specifically user data such as Color. The newly-added call to collectgarbage() should execute a full GC cycle, but has zero effect on the issue.\u003c/p\u003e\n\u003cp\u003eFor clarification, the slowdown is not a temporary condition. It doesn‚Äôt go slow for a few seconds or minutes until some internal state has caught up; it slows down for the entire further duration of the program. ie, it never catches up. When the degradation is extreme (such as after I execute a terrain filter followed by a road filter, or if I do numerous executions of the minimal example) the application becomes quite nearly unusable, with very exaggerated input delay.\u003c/p\u003e\n\u003cp\u003eNow, when I execute the above minimal example, the execution time is about 4 seconds, after which the frame count drops from 100 to 17 and stays there. However, if I remove the line that interpolates colors, then the execution time becomes nearly instantaneous, and no permanent slowdown is observed after execution. If I change the filter so that no Color garbage is generated in the inner loop:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003efor x=0,hw-1,1 do\n\t\t\tfor y=0,hh-1,1 do\n\t\t\t\tlocal nx=x/hw\n\t\t\t\tlocal ny=y/hh\n\t\t\t\tlocal val=0.5\n\t\t\t\t--local col=c1:Lerp(c2, val)\n\t\t\t\tc3.r=c1.r+val*(c2.r-c1.r)\n\t\t\t\tc3.g=c1.g+val*(c2.g-c1.g)\n\t\t\t\tc3.b=c1.b+val*(c2.b-c1.b)\n\t\t\t\tc3.a=c1.a+val*(c2.a-c1.a)\n\t\t\tend\n\t\tend\n\t\tcollectgarbage()\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen the permanent slowdown is also eliminated.\u003c/p\u003e\n\u003cp\u003eI find this‚Ä¶ odd. Admittedly, though I use Lua a lot, I am no expert on its internals. But the problem seems to be a result of a lot of locally-generated Color garbage and the collectgarbage() call effectively does nothing to ameliorate it.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:03:05.900Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4484,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2015-02-02T14:03:05.000Z","cooked":"\u003cp\u003eI‚Äôm wondering if there is a problem with how tolua garbage collection works. I created a filter script that all it does is loop 1000000 times and create a local Color() value. Using collectgarbage(‚Äúcount‚Äù) to display used memory, I get a used mem count of 2437 before the loop and 27692 after the loop. However, calling collectgarbage() for a full gc cycle then displaying the used mem count again I get 22434, meaning that a whole lot of those locals that were created inside the loop are not being garbage collected. Continuous reporting of used memory shows that the used memory is never freed up, regardless of garbage collection. This results in an ever increasing amount of garbage that never gets taken out.\u003c/p\u003e\n\u003cp\u003eThis test triggered a little bit of a memory for me. I haven‚Äôt worked on my game project in many months, but I remembered having performance issues with it and having a general unwillingness to try to deal with it helped me to stop working on it. So I went back and did some memory tracking, and it looks like I am getting gradually accumulating garbage there that never gets collected either. Not in chunks as large as a loop iterating on a 1024x1024 image generates, but over time it adds up. I think this gc problem might be the root cause of the slowdown.\u003c/p\u003e\n\u003cp\u003eI‚Äôve spent quite a few hours googling for potential leaks and problems with tolua++, but I don‚Äôt really find much outside of some old unanswered posts on various forums and one discussion back in 2001 regarding earlier versions of Lua and tolua being unable to collect userdata objects returned by value, but nothing recent. I think that tolua++'s growing obsolescence might be starting to catch up to it, at least so far as lack of internet discussion about it goes.\u003c/p\u003e\n\u003cp\u003eAt this point, I‚Äôm kind of stymied. I could possibly switch over to AngelScript, but that doesn‚Äôt really solve the long term problem I have regarding my poor, neglected game. Guess I‚Äôll do some more digging into the source code to see if I can figure out what‚Äôs going on.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:03:07.142Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":5,"readers_count":4,"score":1.0,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4485,"name":"Lasse √ñ√∂rni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-02-02T14:40:22.000Z","cooked":"\u003cp\u003eYou can also log an issue to raise awareness of this problem. Either it‚Äôs a bug within tolua or we‚Äôre somehow using / exposing the value-type classes incorrectly.\u003c/p\u003e\n\u003cp\u003eEDIT: searched a bit on \u003ca href=\"http://gamedev.net\"\u003egamedev.net\u003c/a\u003e, one possibility is that our Lua function calls executed from C++ side are not restoring the stack position, leading Lua to believe everything created inside the function is still in use.\u003c/p\u003e\n\u003cp\u003eEDIT 2: doesn‚Äôt look to be that, as creating ordinary float value garbage \u003cem\u003eis\u003c/em\u003e cleaned up correctly.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:03:07.211Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"Lasse √ñ√∂rni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://gamedev.net","internal":false,"reflection":false,"clicks":0}],"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4486,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2015-02-02T15:40:46.000Z","cooked":"\u003cp\u003eI feel a little bit like Ouroboros on this, because I‚Äôm certain this is something I‚Äôve tackled in the past. Side effect of going for months or years between programming binges is that you forget a lot of stuff and end up retreading old ground.\u003c/p\u003e\n\u003cp\u003eThe local version of Color:new looks like this (with the conditional compilation stuff for non-release builds removed for clarity):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003estatic int tolua_MathLuaAPI_Color_new00_local(lua_State* tolua_S)\n{\n Color* tolua_ret = (Color*)  Mtolua_new((Color)());\n tolua_pushusertype(tolua_S,(void*)tolua_ret,\"Color\");\n tolua_register_gc(tolua_S,lua_gettop(tolua_S));\n return 1;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI believe this is the one called when performing a statement as \u003cspan class=\"bbcode-b\"\u003elocal c=Color(1,1,1,1)\u003c/span\u003e. So I‚Äôm not certain that it‚Äôs necessarily anything that we are doing wrong. The color is allocated, registered with tolua‚Äôs garbage collector, and pushed onto the stack. On Lua side, obtaining the userdata and storing it in a local does the appropriate stack popping. When I get back from grocery shopping, though, I‚Äôm going to start tracing things more exactly to see if I can figure this out.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T01:03:07.279Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":5,"readers_count":4,"score":1.0,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4488,"name":"Lasse √ñ√∂rni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-02-02T16:14:32.000Z","cooked":"\u003cp\u003eI made a stupid test in 04_StaticScene.lua where it generates a large number of Color objects each frame you keep the W key pressed. The observation was that it does collect (delete) the color objects, but creating a very large number of them (100000+) in one frame results in a permanent slowdown. It‚Äôs as if it leaves the table (?) that held the objects permanently large even after deleting them, so on subsequent frames the GC walks through a large empty table, incurring a performance loss. This is probably a tolua++ architectural issue.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2017-01-02T01:03:07.455Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"Lasse √ñ√∂rni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4610,"name":"","username":"OvermindDL1","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/o/a8b319/{size}.png","created_at":"2015-02-07T23:47:00.000Z","cooked":"\u003cp\u003eWhat were the reasons why luajit are not used exclusively compared to including lua?  Luajit‚Äôs ffi interfaces handle these things far better, as well as the binding code is on the lua side.  Even if the JIT part is not used the normal execution (for iOS or so forth) is still of decent speed and the ffi bindings are still far far better to use than the C bindings.\u003c/p\u003e\n\u003cp\u003ePerhaps instead of luajit just being a subpart of the lua build, maybe it would be better to have it be a whole ScriptLuajit system so it could be used with the full ffi interfaces and other features, which would supply substantial performance benefits when the JIT is enabled compared to using the exceedingly slow lua C binding layer.\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2017-01-02T01:03:15.927Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":42,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4618,"name":"Yao Wei Tjong","username":"weitjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","created_at":"2015-02-08T05:19:23.000Z","cooked":"\u003cp\u003eCompletely agree with all you said above about FFI. I think most of us know that already. The question is, will someone come forward to rewrite the binding and contribute it?\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2017-01-02T01:03:16.473Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"Yao Wei Tjong","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Admin","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":4,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":4627,"name":"","username":"OvermindDL1","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/o/a8b319/{size}.png","created_at":"2015-02-09T05:05:29.000Z","cooked":"\u003caside class=\"quote\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/weitjong/40/4_1.png\" class=\"avatar\"\u003e weitjong:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCompletely agree with all you said above about FFI. I think most of us know that already. The question is, will someone come forward to rewrite the binding and contribute it?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI would in a heartbeat if I had time, I have done so a few times in the past on fairly large systems.  If I get time in the future and it remains undone then I might.  With the FFI binding layer and some well made wrappers you could fix all of the shared pointer issues that the current lua bindings have as well.\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2017-01-02T01:03:17.141Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":814,"topic_slug":"performance-hit-on-procedural-terrain-blending","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":42,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[4465,4466,4468,4484,4485,4486,4488,4610,4618,4627]},"timeline_lookup":[[1,2852],[4,2851],[8,2845],[10,2844]],"suggested_topics":[{"id":7313,"title":"RenderPaths and depth texture","fancy_title":"RenderPaths and depth texture","slug":"renderpaths-and-depth-texture","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/4/4115352ee634066092d24dcacacc24d2ec90206d.png","created_at":"2022-08-15T03:31:55.300Z","last_posted_at":"2022-08-19T11:32:37.386Z","bumped":true,"bumped_at":"2022-08-19T11:32:37.386Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":136,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1404,"username":"shifttab","name":"shifttab","avatar_template":"/user_avatar/discourse.urho3d.io/shifttab/{size}/3250_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7178,"title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","fancy_title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","slug":"medium-quality-technique-for-semi-reflective-specular-glass-in-urho","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/51408fe152ba02eb8b92237cc9a9411c8ee922e6.jpeg","created_at":"2022-01-31T22:57:50.134Z","last_posted_at":"2022-02-01T04:32:37.418Z","bumped":true,"bumped_at":"2022-02-01T04:32:37.418Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":154,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7208,"title":"ScreenSpace Y - Inverted for View3D and RTT","fancy_title":"ScreenSpace Y - Inverted for View3D and RTT","slug":"screenspace-y-inverted-for-view3d-and-rtt","posts_count":14,"reply_count":11,"highest_post_number":15,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/5/506273b200a2f3337a69438a7989218d599e587b_2_823x1024.png","created_at":"2022-02-24T23:11:35.590Z","last_posted_at":"2022-03-09T12:27:07.577Z","bumped":true,"bumped_at":"2022-03-09T12:27:07.577Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":268,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1004,"username":"GoldenThumbs","name":"Golden Thumbs","avatar_template":"/user_avatar/discourse.urho3d.io/goldenthumbs/{size}/1669_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":627,"username":"George1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/9e8a1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1335,"username":"justanotherdev","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/e8c25b/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7281,"title":"Cannot launch + Converting .fbx to .ani","fancy_title":"Cannot launch + Converting .fbx to .ani","slug":"cannot-launch-converting-fbx-to-ani","posts_count":14,"reply_count":10,"highest_post_number":14,"image_url":null,"created_at":"2022-06-17T04:59:42.992Z","last_posted_at":"2022-06-20T16:21:59.555Z","bumped":true,"bumped_at":"2022-06-20T16:21:59.555Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":258,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1526,"username":"NoobBeggar","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/e68b1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7098,"title":"Cartoon Fire Effect","fancy_title":"Cartoon Fire Effect","slug":"cartoon-fire-effect","posts_count":6,"reply_count":0,"highest_post_number":6,"image_url":null,"created_at":"2021-12-10T04:08:49.887Z","last_posted_at":"2021-12-12T02:49:51.076Z","bumped":true,"bumped_at":"2021-12-12T02:49:51.076Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":274,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]}],"tags_descriptions":{},"id":814,"title":"Performance hit on procedural terrain blending","fancy_title":"Performance hit on procedural terrain blending","posts_count":10,"created_at":"2015-02-01T15:47:52.000Z","views":984,"reply_count":0,"like_count":0,"last_posted_at":"2015-02-09T05:05:29.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"performance-hit-on-procedural-terrain-blending","category_id":10,"word_count":1925,"deleted_at":null,"user_id":30,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_814","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":10,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":4,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":3,"username":"cadaver","name":"Lasse √ñ√∂rni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":42,"username":"OvermindDL1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/o/a8b319/{size}.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":4}],"created_by":{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"last_poster":{"id":42,"username":"OvermindDL1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/o/a8b319/{size}.png"},"links":[{"url":"https://github.com/JTippetts/U3DTerrainEditor/blob/master/Bin/TerrainEditFilters/dirtgrass.lua","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":30,"domain":"github.com","root_domain":"github.com"}]}}